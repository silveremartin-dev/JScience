/*
 * JScience - Java(TM) Tools and Libraries for the Advancement of Sciences.
 * Copyright (C) 2025-2026 - Silvere Martin-Michiellot and Gemini AI (Google DeepMind)
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

package org.jscience.astronomy.solarsystem.artificialsatellites;

/**
 * 
 */
class DEEP {
    /**
     * DOCUMENT ME!
     */
    static double DAY;

    /**
     * DOCUMENT ME!
     */
    static double PREEP;

    /**
     * DOCUMENT ME!
     */
    static double XNODCE;

    /**
     * DOCUMENT ME!
     */
    static double ATIME;

    /**
     * DOCUMENT ME!
     */
    static double DELT;

    /**
     * DOCUMENT ME!
     */
    static double SAVTSN;

    /**
     * DOCUMENT ME!
     */
    static double STEP2;

    /**
     * DOCUMENT ME!
     */
    static double STEPN;

    /**
     * DOCUMENT ME!
     */
    static double STEPP;

    /**
     * DOCUMENT ME!
     */
    static double ZNS;

    /**
     * DOCUMENT ME!
     */
    static double C1SS;

    /**
     * DOCUMENT ME!
     */
    static double ZES;

    /**
     * DOCUMENT ME!
     */
    static double ZNL;

    /**
     * DOCUMENT ME!
     */
    static double C1L;

    /**
     * DOCUMENT ME!
     */
    static double ZEL;

    /**
     * DOCUMENT ME!
     */
    static double ZCOSIS;

    /**
     * DOCUMENT ME!
     */
    static double ZSINIS;

    /**
     * DOCUMENT ME!
     */
    static double ZSINGS;

    /**
     * DOCUMENT ME!
     */
    static double ZCOSGS;

    /**
     * DOCUMENT ME!
     */
    static double ZCOSHS;

    /**
     * DOCUMENT ME!
     */
    static double ZSINHS;

    /**
     * DOCUMENT ME!
     */
    static double Q22;

    /**
     * DOCUMENT ME!
     */
    static double Q31;

    /**
     * DOCUMENT ME!
     */
    static double Q33;

    /**
     * DOCUMENT ME!
     */
    static double G22;

    /**
     * DOCUMENT ME!
     */
    static double G32;

    /**
     * DOCUMENT ME!
     */
    static double G44;

    /**
     * DOCUMENT ME!
     */
    static double G52;

    /**
     * DOCUMENT ME!
     */
    static double G54;

    /**
     * DOCUMENT ME!
     */
    static double ROOT22;

    /**
     * DOCUMENT ME!
     */
    static double ROOT32;

    /**
     * DOCUMENT ME!
     */
    static double ROOT44;

    /**
     * DOCUMENT ME!
     */
    static double ROOT52;

    /**
     * DOCUMENT ME!
     */
    static double ROOT54;

    /**
     * DOCUMENT ME!
     */
    static double THDT;

    static {
        ZNS = 1.19459E-5f;
        C1SS = 2.9864797E-6f;
        ZES = .01675f;
        ZNL = 1.5835218E-4f;
        C1L = 4.7968065E-7f;
        ZEL = .05490f;
        ZCOSIS = .91744867f;
        ZSINIS = .39785416f;
        ZSINGS = -.98088458f;
        ZCOSGS = .1945905f;
        ZCOSHS = 1.0f;
        ZSINHS = 0.0f;
        Q22 = 1.7891679E-6f;
        Q31 = 2.1460748E-6f;
        Q33 = 2.2123015E-7f;
        G22 = 5.7686396f;
        G32 = 0.95240898f;
        G44 = 1.8014998f;
        G52 = 1.0508330f;
        G54 = 4.4108898f;
        ROOT22 = 1.7891679E-6f;
        ROOT32 = 3.7393792E-7f;
        ROOT44 = 7.3636953E-9f;
        ROOT52 = 1.1428639E-7f;
        ROOT54 = 2.1765803E-9f;
        THDT = 4.3752691E-3f;
    }

    /**
     * DOCUMENT ME!
     */
    static double THGR;

    /**
     * DOCUMENT ME!
     */
    static double EQ;

    /**
     * DOCUMENT ME!
     */
    static double XNQ;

    /**
     * DOCUMENT ME!
     */
    static double AQNV;

    /**
     * DOCUMENT ME!
     */
    static double XQNCL;

    /**
     * DOCUMENT ME!
     */
    static double XMAO;

    /**
     * DOCUMENT ME!
     */
    static double XPIDOT;

    /**
     * DOCUMENT ME!
     */
    static double SINQ;

    /**
     * DOCUMENT ME!
     */
    static double COSQ;

    /**
     * DOCUMENT ME!
     */
    static double OMEGAQ;

    /**
     * DOCUMENT ME!
     */
    static double STEM;

    /**
     * DOCUMENT ME!
     */
    static double CTEM;

    /**
     * DOCUMENT ME!
     */
    static double ZCOSIL;

    /**
     * DOCUMENT ME!
     */
    static double ZSINIL;

    /**
     * DOCUMENT ME!
     */
    static double ZSINHL;

    /**
     * DOCUMENT ME!
     */
    static double ZCOSHL;

    /**
     * DOCUMENT ME!
     */
    static double C;

    /**
     * DOCUMENT ME!
     */
    static double GAM;

    /**
     * DOCUMENT ME!
     */
    static double ZMOL;

    /**
     * DOCUMENT ME!
     */
    static double ZX;

    /**
     * DOCUMENT ME!
     */
    static double ZY;

    /**
     * DOCUMENT ME!
     */
    static double ZCOSGL;

    /**
     * DOCUMENT ME!
     */
    static double ZSINGL;

    /**
     * DOCUMENT ME!
     */
    static double ZMOS;

    /**
     * DOCUMENT ME!
     */
    static int LS;

    /**
     * DOCUMENT ME!
     */
    static double ZCOSG;

    /**
     * DOCUMENT ME!
     */
    static double ZSING;

    /**
     * DOCUMENT ME!
     */
    static double ZCOSI;

    /**
     * DOCUMENT ME!
     */
    static double ZSINI;

    /**
     * DOCUMENT ME!
     */
    static double ZCOSH;

    /**
     * DOCUMENT ME!
     */
    static double ZSINH;

    /**
     * DOCUMENT ME!
     */
    static double CC;

    /**
     * DOCUMENT ME!
     */
    static double ZN;

    /**
     * DOCUMENT ME!
     */
    static double ZE;

    /**
     * DOCUMENT ME!
     */
    static double ZMO;

    /**
     * DOCUMENT ME!
     */
    static double XNOI;

    /**
     * DOCUMENT ME!
     */
    static double A1;

    /**
     * DOCUMENT ME!
     */
    static double A3;

    /**
     * DOCUMENT ME!
     */
    static double A7;

    /**
     * DOCUMENT ME!
     */
    static double A8;

    /**
     * DOCUMENT ME!
     */
    static double A9;

    /**
     * DOCUMENT ME!
     */
    static double A10;

    /**
     * DOCUMENT ME!
     */
    static double A2;

    /**
     * DOCUMENT ME!
     */
    static double A4;

    /**
     * DOCUMENT ME!
     */
    static double A5;

    /**
     * DOCUMENT ME!
     */
    static double A6;

    /**
     * DOCUMENT ME!
     */
    static double X1;

    /**
     * DOCUMENT ME!
     */
    static double X2;

    /**
     * DOCUMENT ME!
     */
    static double X3;

    /**
     * DOCUMENT ME!
     */
    static double X4;

    /**
     * DOCUMENT ME!
     */
    static double X5;

    /**
     * DOCUMENT ME!
     */
    static double X6;

    /**
     * DOCUMENT ME!
     */
    static double X7;

    /**
     * DOCUMENT ME!
     */
    static double X8;

    /**
     * DOCUMENT ME!
     */
    static double Z31;

    /**
     * DOCUMENT ME!
     */
    static double Z32;

    /**
     * DOCUMENT ME!
     */
    static double Z33;

    /**
     * DOCUMENT ME!
     */
    static double Z1;

    /**
     * DOCUMENT ME!
     */
    static double Z2;

    /**
     * DOCUMENT ME!
     */
    static double Z3;

    /**
     * DOCUMENT ME!
     */
    static double Z11;

    /**
     * DOCUMENT ME!
     */
    static double Z12;

    /**
     * DOCUMENT ME!
     */
    static double Z13;

    /**
     * DOCUMENT ME!
     */
    static double Z21;

    /**
     * DOCUMENT ME!
     */
    static double Z22;

    /**
     * DOCUMENT ME!
     */
    static double Z23;

    /**
     * DOCUMENT ME!
     */
    static double S1;

    /**
     * DOCUMENT ME!
     */
    static double S2;

    /**
     * DOCUMENT ME!
     */
    static double S3;

    /**
     * DOCUMENT ME!
     */
    static double S4;

    /**
     * DOCUMENT ME!
     */
    static double S5;

    /**
     * DOCUMENT ME!
     */
    static double S6;

    /**
     * DOCUMENT ME!
     */
    static double S7;

    /**
     * DOCUMENT ME!
     */
    static double SE;

    /**
     * DOCUMENT ME!
     */
    static double SI;

    /**
     * DOCUMENT ME!
     */
    static double SL;

    /**
     * DOCUMENT ME!
     */
    static double SGH;

    /**
     * DOCUMENT ME!
     */
    static double SH;

    /**
     * DOCUMENT ME!
     */
    static double EE2;

    /**
     * DOCUMENT ME!
     */
    static double E3;

    /**
     * DOCUMENT ME!
     */
    static double XI2;

    /**
     * DOCUMENT ME!
     */
    static double XI3;

    /**
     * DOCUMENT ME!
     */
    static double XL2;

    /**
     * DOCUMENT ME!
     */
    static double XL3;

    /**
     * DOCUMENT ME!
     */
    static double XL4;

    /**
     * DOCUMENT ME!
     */
    static double XGH2;

    /**
     * DOCUMENT ME!
     */
    static double XGH3;

    /**
     * DOCUMENT ME!
     */
    static double XGH4;

    /**
     * DOCUMENT ME!
     */
    static double XH2;

    /**
     * DOCUMENT ME!
     */
    static double XH3;

    /**
     * DOCUMENT ME!
     */
    static double SSE;

    /**
     * DOCUMENT ME!
     */
    static double SSI;

    /**
     * DOCUMENT ME!
     */
    static double SSL;

    /**
     * DOCUMENT ME!
     */
    static double SSH;

    /**
     * DOCUMENT ME!
     */
    static double SSG;

    /**
     * DOCUMENT ME!
     */
    static double SE2;

    /**
     * DOCUMENT ME!
     */
    static double SI2;

    /**
     * DOCUMENT ME!
     */
    static double SL2;

    /**
     * DOCUMENT ME!
     */
    static double SGH2;

    /**
     * DOCUMENT ME!
     */
    static double SH2;

    /**
     * DOCUMENT ME!
     */
    static double SE3;

    /**
     * DOCUMENT ME!
     */
    static double SI3;

    /**
     * DOCUMENT ME!
     */
    static double SL3;

    /**
     * DOCUMENT ME!
     */
    static double SGH3;

    /**
     * DOCUMENT ME!
     */
    static double SH3;

    /**
     * DOCUMENT ME!
     */
    static double SL4;

    /**
     * DOCUMENT ME!
     */
    static double SGH4;

    /**
     * DOCUMENT ME!
     */
    static int IRESFL;

    /**
     * DOCUMENT ME!
     */
    static int ISYNFL;

    /**
     * DOCUMENT ME!
     */
    static double EOC;

    /**
     * DOCUMENT ME!
     */
    static double G201;

    /**
     * DOCUMENT ME!
     */
    static double G211;

    /**
     * DOCUMENT ME!
     */
    static double G310;

    /**
     * DOCUMENT ME!
     */
    static double G322;

    /**
     * DOCUMENT ME!
     */
    static double G410;

    /**
     * DOCUMENT ME!
     */
    static double G422;

    /**
     * DOCUMENT ME!
     */
    static double G520;

    /**
     * DOCUMENT ME!
     */
    static double G533;

    /**
     * DOCUMENT ME!
     */
    static double G521;

    /**
     * DOCUMENT ME!
     */
    static double G532;

    /**
     * DOCUMENT ME!
     */
    static double SINI2;

    /**
     * DOCUMENT ME!
     */
    static double F220;

    /**
     * DOCUMENT ME!
     */
    static double F221;

    /**
     * DOCUMENT ME!
     */
    static double F321;

    /**
     * DOCUMENT ME!
     */
    static double F322;

    /**
     * DOCUMENT ME!
     */
    static double F441;

    /**
     * DOCUMENT ME!
     */
    static double F442;

    /**
     * DOCUMENT ME!
     */
    static double F522;

    /**
     * DOCUMENT ME!
     */
    static double F523;

    /**
     * DOCUMENT ME!
     */
    static double F542;

    /**
     * DOCUMENT ME!
     */
    static double F543;

    /**
     * DOCUMENT ME!
     */
    static double XNO2;

    /**
     * DOCUMENT ME!
     */
    static double AINV2;

    /**
     * DOCUMENT ME!
     */
    static double TEMP1;

    /**
     * DOCUMENT ME!
     */
    static double TEMP;

    /**
     * DOCUMENT ME!
     */
    static double D2201;

    /**
     * DOCUMENT ME!
     */
    static double D2211;

    /**
     * DOCUMENT ME!
     */
    static double D3210;

    /**
     * DOCUMENT ME!
     */
    static double D3222;

    /**
     * DOCUMENT ME!
     */
    static double D4410;

    /**
     * DOCUMENT ME!
     */
    static double D4422;

    /**
     * DOCUMENT ME!
     */
    static double D5220;

    /**
     * DOCUMENT ME!
     */
    static double D5232;

    /**
     * DOCUMENT ME!
     */
    static double D5421;

    /**
     * DOCUMENT ME!
     */
    static double D5433;

    /**
     * DOCUMENT ME!
     */
    static double XLAMO;

    /**
     * DOCUMENT ME!
     */
    static double BFACT;

    /**
     * DOCUMENT ME!
     */
    static double G200;

    /**
     * DOCUMENT ME!
     */
    static double G300;

    /**
     * DOCUMENT ME!
     */
    static double F311;

    /**
     * DOCUMENT ME!
     */
    static double F330;

    /**
     * DOCUMENT ME!
     */
    static double DEL1;

    /**
     * DOCUMENT ME!
     */
    static double DEL2;

    /**
     * DOCUMENT ME!
     */
    static double DEL3;

    /**
     * DOCUMENT ME!
     */
    static double FASX2;

    /**
     * DOCUMENT ME!
     */
    static double FASX4;

    /**
     * DOCUMENT ME!
     */
    static double FASX6;

    /**
     * DOCUMENT ME!
     */
    static double XFACT;

    /**
     * DOCUMENT ME!
     */
    static double XLI;

    /**
     * DOCUMENT ME!
     */
    static double XNI;

    /**
     * DOCUMENT ME!
     */
    static int IRET;

    /**
     * DOCUMENT ME!
     */
    static int IRETN;

    /**
     * DOCUMENT ME!
     */
    static double FT;

    /**
     * DOCUMENT ME!
     */
    static double XNDOT;

    /**
     * DOCUMENT ME!
     */
    static double XNDDT;

    /**
     * DOCUMENT ME!
     */
    static double OMGDT;

    /**
     * DOCUMENT ME!
     */
    static double XOMI;

    /**
     * DOCUMENT ME!
     */
    static double X2OMI;

    /**
     * DOCUMENT ME!
     */
    static double X2LI;

    /**
     * DOCUMENT ME!
     */
    static double XLDOT;

    /**
     * DOCUMENT ME!
     */
    static double XL;

    /**
     * DOCUMENT ME!
     */
    static double T;

    /**
     * DOCUMENT ME!
     */
    static double ZM;

    /**
     * DOCUMENT ME!
     */
    static double ZF;

    /**
     * DOCUMENT ME!
     */
    static double SINZF;

    /**
     * DOCUMENT ME!
     */
    static double F2;

    /**
     * DOCUMENT ME!
     */
    static double F3;

    /**
     * DOCUMENT ME!
     */
    static double SES;

    /**
     * DOCUMENT ME!
     */
    static double SIS;

    /**
     * DOCUMENT ME!
     */
    static double SLS;

    /**
     * DOCUMENT ME!
     */
    static double SGHS;

    /**
     * DOCUMENT ME!
     */
    static double SHS;

    /**
     * DOCUMENT ME!
     */
    static double SEL;

    /**
     * DOCUMENT ME!
     */
    static double SIL;

    /**
     * DOCUMENT ME!
     */
    static double SLL;

    /**
     * DOCUMENT ME!
     */
    static double SGHL;

    /**
     * DOCUMENT ME!
     */
    static double SHL;

    /**
     * DOCUMENT ME!
     */
    static double PE;

    /**
     * DOCUMENT ME!
     */
    static double PINC;

    /**
     * DOCUMENT ME!
     */
    static double PL;

    /**
     * DOCUMENT ME!
     */
    static double PGH;

    /**
     * DOCUMENT ME!
     */
    static double PH;

    /**
     * DOCUMENT ME!
     */
    static double SINIQ;

    /**
     * DOCUMENT ME!
     */
    static double COSIQ;

    /**
     * DOCUMENT ME!
     */
    static double SINOK;

    /**
     * DOCUMENT ME!
     */
    static double COSOK;

    /**
     * DOCUMENT ME!
     */
    static double ALFDP;

    /**
     * DOCUMENT ME!
     */
    static double BETDP;

    /**
     * DOCUMENT ME!
     */
    static double DALF;

    /**
     * DOCUMENT ME!
     */
    static double DBET;

    /**
     * DOCUMENT ME!
     */
    static double XLS;

    /**
     * DOCUMENT ME!
     */
    static double DLS;

    /**
     * DOCUMENT ME!
     */
    static double SINIS;

    /**
     * DOCUMENT ME!
     */
    static double COSIS;

/**
     * Deny the ability to construct an instance of this class.
     */
    private DEEP() {
    }

    /**
     * DOCUMENT ME!
     *
     * @param es DOCUMENT ME!
     * @param EQSQ DOCUMENT ME!
     * @param SINIQ DOCUMENT ME!
     * @param COSIQ DOCUMENT ME!
     * @param RTEQSQ DOCUMENT ME!
     * @param AO DOCUMENT ME!
     * @param COSQ2 DOCUMENT ME!
     * @param SINOMO DOCUMENT ME!
     * @param COSOMO DOCUMENT ME!
     * @param BSQ DOCUMENT ME!
     * @param XLLDOT DOCUMENT ME!
     * @param OMGDT DOCUMENT ME!
     * @param XNODOT DOCUMENT ME!
     * @param XNODP DOCUMENT ME!
     */
    static void DPINIT(ElementSet es, double EQSQ, double SINIQ, double COSIQ,
        double RTEQSQ, double AO, double COSQ2, double SINOMO, double COSOMO,
        double BSQ, double XLLDOT, double OMGDT, double XNODOT, double XNODP) {
        DEEP.OMGDT = OMGDT;
        DEEP.SINIQ = SINIQ;
        DEEP.COSIQ = COSIQ;
        THGR = MathUtils.THETAG(es.DS50);
        EQ = es.EO;
        XNQ = XNODP;
        AQNV = 1.f / AO;
        XQNCL = es.XINCL;
        XMAO = es.XMO;
        XPIDOT = OMGDT + XNODOT;
        SINQ = Math.sin(es.XNODEO);
        COSQ = Math.cos(es.XNODEO);
        OMEGAQ = es.OMEGAO;

        // INITIALIZE LUNAR SOLAR TERMS
        DAY = es.DS50 + 18261.5;

        if (DAY != PREEP) {
            PREEP = DAY;
            XNODCE = 4.5236020 - (9.2422029E-4 * DAY);
            STEM = Math.sin(XNODCE);
            CTEM = Math.cos(XNODCE);
            ZCOSIL = .91375164f - (.03568096f * CTEM);
            ZSINIL = Math.sqrt(1. - (ZCOSIL * ZCOSIL));
            ZSINHL = (.089683511f * STEM) / ZSINIL;
            ZCOSHL = Math.sqrt(1. - (ZSINHL * ZSINHL));
            C = (4.7199672 + (.22997150 * DAY));
            GAM = (5.8351514 + (.0019443680 * DAY));
            ZMOL = MathUtils.FMOD2P(C - GAM);
            ZX = (.39785416f * STEM) / ZSINIL;
            ZY = (ZCOSHL * CTEM) + (0.91744867f * ZSINHL * STEM);
            ZX = MathUtils.ACTAN(ZX, ZY);
            ZX = ((GAM + ZX) - XNODCE);
            ZCOSGL = Math.cos(ZX);
            ZSINGL = Math.sin(ZX);
            ZMOS = (6.2565837 + (.017201977 * DAY));
            ZMOS = MathUtils.FMOD2P(ZMOS);
        }

        // DO SOLAR TERMS
        LS = 0;
        SAVTSN = 1.e20;
        ZCOSG = ZCOSGS;
        ZSING = ZSINGS;
        ZCOSI = ZCOSIS;
        ZSINI = ZSINIS;
        ZCOSH = COSQ;
        ZSINH = SINQ;
        CC = C1SS;
        ZN = ZNS;
        ZE = ZES;
        ZMO = ZMOS;
        XNOI = 1.f / XNQ;
        LS = 30;

        while (true) {
            A1 = (ZCOSG * ZCOSH) + (ZSING * ZCOSI * ZSINH);
            A3 = (-ZSING * ZCOSH) + (ZCOSG * ZCOSI * ZSINH);
            A7 = (-ZCOSG * ZSINH) + (ZSING * ZCOSI * ZCOSH);
            A8 = ZSING * ZSINI;
            A9 = (ZSING * ZSINH) + (ZCOSG * ZCOSI * ZCOSH);
            A10 = ZCOSG * ZSINI;
            A2 = (COSIQ * A7) + (SINIQ * A8);
            A4 = (COSIQ * A9) + (SINIQ * A10);
            A5 = (-SINIQ * A7) + (COSIQ * A8);
            A6 = (-SINIQ * A9) + (COSIQ * A10);

            X1 = (A1 * COSOMO) + (A2 * SINOMO);
            X2 = (A3 * COSOMO) + (A4 * SINOMO);
            X3 = (-A1 * SINOMO) + (A2 * COSOMO);
            X4 = (-A3 * SINOMO) + (A4 * COSOMO);
            X5 = A5 * SINOMO;
            X6 = A6 * SINOMO;
            X7 = A5 * COSOMO;
            X8 = A6 * COSOMO;

            Z31 = (12.f * X1 * X1) - (3.f * X3 * X3);
            Z32 = (24.f * X1 * X2) - (6.f * X3 * X4);
            Z33 = (12.f * X2 * X2) - (3.f * X4 * X4);
            Z1 = (3.f * ((A1 * A1) + (A2 * A2))) + (Z31 * EQSQ);
            Z2 = (6.f * ((A1 * A3) + (A2 * A4))) + (Z32 * EQSQ);
            Z3 = (3.f * ((A3 * A3) + (A4 * A4))) + (Z33 * EQSQ);
            Z11 = (-6.f * A1 * A5) +
                (EQSQ * ((-24.f * X1 * X7) - (6.f * X3 * X5)));
            Z12 = (-6.f * ((A1 * A6) + (A3 * A5))) +
                (EQSQ * ((-24.f * ((X2 * X7) + (X1 * X8))) -
                (6.f * ((X3 * X6) + (X4 * X5)))));
            Z13 = (-6.f * A3 * A6) +
                (EQSQ * ((-24.f * X2 * X8) - (6.f * X4 * X6)));
            Z21 = (6.f * A2 * A5) +
                (EQSQ * ((24.f * X1 * X5) - (6.f * X3 * X7)));
            Z22 = (6.f * ((A4 * A5) + (A2 * A6))) +
                (EQSQ * ((24.f * ((X2 * X5) + (X1 * X6))) -
                (6.f * ((X4 * X7) + (X3 * X8)))));
            Z23 = (6.f * A4 * A6) +
                (EQSQ * ((24.f * X2 * X6) - (6.f * X4 * X8)));
            Z1 = Z1 + Z1 + (BSQ * Z31);
            Z2 = Z2 + Z2 + (BSQ * Z32);
            Z3 = Z3 + Z3 + (BSQ * Z33);
            S3 = CC * XNOI;
            S2 = (-.5f * S3) / RTEQSQ;
            S4 = S3 * RTEQSQ;
            S1 = -15.f * EQ * S4;
            S5 = (X1 * X3) + (X2 * X4);
            S6 = (X2 * X3) + (X1 * X4);
            S7 = (X2 * X4) - (X1 * X3);
            SE = S1 * ZN * S5;
            SI = S2 * ZN * (Z11 + Z13);
            SL = -ZN * S3 * ((Z1 + Z3) - 14.f - (6.f * EQSQ));
            SGH = S4 * ZN * ((Z31 + Z33) - 6.f);
            SH = -ZN * S2 * (Z21 + Z23);

            if (XQNCL < 5.2359877E-2) {
                SH = 0.0f;
            }

            EE2 = 2.f * S1 * S6;
            E3 = 2.f * S1 * S7;
            XI2 = 2.f * S2 * Z12;
            XI3 = 2.f * S2 * (Z13 - Z11);
            XL2 = -2.f * S3 * Z2;
            XL3 = -2.f * S3 * (Z3 - Z1);
            XL4 = -2.f * S3 * (-21.f - (9.f * EQSQ)) * ZE;
            XGH2 = 2.f * S4 * Z32;
            XGH3 = 2.f * S4 * (Z33 - Z31);
            XGH4 = -18.f * S4 * ZE;
            XH2 = -2.f * S2 * Z22;
            XH3 = -2.f * S2 * (Z23 - Z21);

            if (LS == 40) {
                break;
            }

            // DO LUNAR TERMS
            SSE = SE;
            SSI = SI;
            SSL = SL;
            SSH = SH / SINIQ;
            SSG = SGH - (COSIQ * SSH);
            SE2 = EE2;
            SI2 = XI2;
            SL2 = XL2;
            SGH2 = XGH2;
            SH2 = XH2;
            SE3 = E3;
            SI3 = XI3;
            SL3 = XL3;
            SGH3 = XGH3;
            SH3 = XH3;
            SL4 = XL4;
            SGH4 = XGH4;
            LS = 1;
            ZCOSG = ZCOSGL;
            ZSING = ZSINGL;
            ZCOSI = ZCOSIL;
            ZSINI = ZSINIL;
            ZCOSH = (ZCOSHL * COSQ) + (ZSINHL * SINQ);
            ZSINH = (SINQ * ZCOSHL) - (COSQ * ZSINHL);
            ZN = ZNL;
            CC = C1L;
            ZE = ZEL;
            ZMO = ZMOL;
            LS = 40;
        }

        SSE = SSE + SE;
        SSI = SSI + SI;
        SSL = SSL + SL;
        SSG = (SSG + SGH) - (COSIQ / SINIQ * SH);
        SSH = SSH + (SH / SINIQ);

        // GEOPOTENTIAL RESONANCE INITIALIZATION FOR 12 HOUR ORBITS
        IRESFL = 0;
        ISYNFL = 0;

        if ((XNQ >= .0052359877) || (XNQ <= .0034906585)) {
            if ((XNQ < 8.26E-3) || (XNQ > 9.24E-3)) {
                return;
            }

            if (EQ < 0.5) {
                return;
            }

            IRESFL = 1;
            EOC = EQ * EQSQ;
            G201 = -.306f - ((EQ - .64f) * .440f);

            if (EQ <= .65) {
                G211 = 3.616f - (13.247f * EQ) + (16.290f * EQSQ);
                G310 = (-19.302f + (117.390f * EQ)) - (228.419f * EQSQ) +
                    (156.591f * EOC);
                G322 = (-18.9068f + (109.7927f * EQ)) - (214.6334f * EQSQ) +
                    (146.5816f * EOC);
                G410 = (-41.122f + (242.694f * EQ)) - (471.094f * EQSQ) +
                    (313.953f * EOC);
                G422 = (-146.407f + (841.880f * EQ)) - (1629.014f * EQSQ) +
                    (1083.435f * EOC);
                G520 = (-532.114f + (3017.977f * EQ)) - (5740f * EQSQ) +
                    (3708.276f * EOC);
            } else {
                G211 = (-72.099f + (331.819f * EQ)) - (508.738f * EQSQ) +
                    (266.724f * EOC);
                G310 = (-346.844f + (1582.851f * EQ)) - (2415.925f * EQSQ) +
                    (1246.113f * EOC);
                G322 = (-342.585f + (1554.908f * EQ)) - (2366.899f * EQSQ) +
                    (1215.972f * EOC);
                G410 = (-1052.797f + (4758.686f * EQ)) - (7193.992f * EQSQ) +
                    (3651.957f * EOC);
                G422 = (-3581.69f + (16178.11f * EQ)) - (24462.77f * EQSQ) +
                    (12422.52f * EOC);

                if (EQ <= .715) {
                    G520 = 1464.74f - (4664.75f * EQ) + (3763.64f * EQSQ);
                } else {
                    G520 = (-5149.66f + (29936.92f * EQ)) - (54087.36f * EQSQ) +
                        (31324.56f * EOC);
                }
            }

            if (EQ < .7) {
                G533 = (-919.2277f + (4988.61f * EQ)) - (9064.77f * EQSQ) +
                    (5542.21f * EOC);
                G521 = (-822.71072f + (4568.6173f * EQ)) - (8491.4146f * EQSQ) +
                    (5337.524f * EOC);
                G532 = (-853.666f + (4690.25f * EQ)) - (8624.77f * EQSQ) +
                    (5341.4f * EOC);
            } else {
                G533 = (-37995.78f + (161616.52f * EQ)) - (229838.2f * EQSQ) +
                    (109377.94f * EOC);
                G521 = (-51752.104f + (218913.95f * EQ)) - (309468.16f * EQSQ) +
                    (146349.42f * EOC);
                G532 = (-40023.88f + (170470.89f * EQ)) - (242699.48f * EQSQ) +
                    (115605.82f * EOC);
            }

            SINI2 = SINIQ * SINIQ;
            F220 = .75f * (1.f + (2.f * COSIQ) + COSQ2);
            F221 = 1.5f * SINI2;
            F321 = 1.875f * SINIQ * (1.f - (2.f * COSIQ) - (3.f * COSQ2));
            F322 = -1.875f * SINIQ * ((1.f + (2.f * COSIQ)) - (3.f * COSQ2));
            F441 = 35.f * SINI2 * F220;
            F442 = 39.3750f * SINI2 * SINI2;
            F522 = 9.84375f * SINIQ * ((SINI2 * (1.f - (2.f * COSIQ) -
                (5.f * COSQ2))) +
                (.33333333f * (-2.f + (4.f * COSIQ) + (6.f * COSQ2))));
            F523 = SINIQ * ((4.92187512f * SINI2 * (-2.f - (4.f * COSIQ) +
                (10.f * COSQ2))) +
                (6.56250012f * ((1.f + (2.f * COSIQ)) - (3.f * COSQ2))));
            F542 = 29.53125f * SINIQ * (2.f - (8.f * COSIQ) +
                (COSQ2 * (-12.f + (8.f * COSIQ) + (10.f * COSQ2))));
            F543 = 29.53125f * SINIQ * (-2.f - (8.f * COSIQ) +
                (COSQ2 * ((12.f + (8.f * COSIQ)) - (10.f * COSQ2))));
            XNO2 = XNQ * XNQ;
            AINV2 = AQNV * AQNV;
            TEMP1 = 3.f * XNO2 * AINV2;
            TEMP = TEMP1 * ROOT22;
            D2201 = TEMP * F220 * G201;
            D2211 = TEMP * F221 * G211;
            TEMP1 = TEMP1 * AQNV;
            TEMP = TEMP1 * ROOT32;
            D3210 = TEMP * F321 * G310;
            D3222 = TEMP * F322 * G322;
            TEMP1 = TEMP1 * AQNV;
            TEMP = 2.f * TEMP1 * ROOT44;
            D4410 = TEMP * F441 * G410;
            D4422 = TEMP * F442 * G422;
            TEMP1 = TEMP1 * AQNV;
            TEMP = TEMP1 * ROOT52;
            D5220 = TEMP * F522 * G520;
            D5232 = TEMP * F523 * G532;
            TEMP = 2.f * TEMP1 * ROOT54;
            D5421 = TEMP * F542 * G521;
            D5433 = TEMP * F543 * G533;
            XLAMO = ((XMAO + (2.0f * es.XNODEO)) - (2.0 * THGR));
            BFACT = (XLLDOT + XNODOT + XNODOT) - THDT - THDT;
            BFACT = BFACT + SSL + SSH + SSH;
        } else {
            // SYNCHRONOUS RESONANCE TERMS INITIALIZATION
            IRESFL = 1;
            ISYNFL = 1;
            G200 = 1.0f + (EQSQ * (-2.5f + (.8125f * EQSQ)));
            G310 = 1.0f + (2.0f * EQSQ);
            G300 = 1.0f + (EQSQ * (-6.0f + (6.60937f * EQSQ)));
            F220 = .75f * (1.f + COSIQ) * (1.f + COSIQ);
            F311 = (.9375f * SINIQ * SINIQ * (1.f + (3.f * COSIQ))) -
                (.75f * (1.f + COSIQ));
            F330 = 1.f + COSIQ;
            F330 = 1.875f * F330 * F330 * F330;
            DEL1 = 3.f * XNQ * XNQ * AQNV * AQNV;
            DEL2 = 2.f * DEL1 * F220 * G200 * Q22;
            DEL3 = 3.f * DEL1 * F330 * G300 * Q33 * AQNV;
            DEL1 = DEL1 * F311 * G310 * Q31 * AQNV;
            FASX2 = .13130908f;
            FASX4 = 2.8843198f;
            FASX6 = .37448087f;
            XLAMO = ((XMAO + es.XNODEO + es.OMEGAO) - THGR);
            BFACT = (XLLDOT + XPIDOT) - THDT;
            BFACT = BFACT + SSL + SSG + SSH;
        }

        XFACT = BFACT - XNQ;

        // INITIALIZE INTEGRATOR
        XLI = XLAMO;
        XNI = XNQ;
        ATIME = 0.0;
        STEPP = 720.0;
        STEPN = -720.0;
        STEP2 = 259200.0;
    }

    /**
     * DOCUMENT ME!
     *
     * @param es DOCUMENT ME!
     * @param XLL DOCUMENT ME!
     * @param OMGASM DOCUMENT ME!
     * @param XNODES DOCUMENT ME!
     * @param EM DOCUMENT ME!
     * @param XINC DOCUMENT ME!
     * @param XN DOCUMENT ME!
     * @param T DOCUMENT ME!
     */
    static void DPSEC(ElementSet es, DoubleRef XLL, DoubleRef OMGASM,
        DoubleRef XNODES, DoubleRef EM, DoubleRef XINC, DoubleRef XN, double T) {
        DEEP.T = T;
        XLL.value = XLL.value + (SSL * T);
        OMGASM.value = OMGASM.value + (SSG * T);
        XNODES.value = XNODES.value + (SSH * T);
        EM.value = es.EO + (SSE * T);
        XINC.value = es.XINCL + (SSI * T);

        if (XINC.value < 0.) {
            XINC.value = -XINC.value;
            XNODES.value = XNODES.value + C2.PI;
            OMGASM.value = OMGASM.value - C2.PI;
        }

        if (IRESFL == 0) {
            return;
        }

        while (true) {
            boolean checkIRETN = true;

            if ((ATIME == 0.0) || ((T >= 0.0) && (ATIME < 0.0)) ||
                    ((T < 0.0) && (ATIME >= 0.0))) {
                // EPOCH RESTART
                if (T < 0.0) {
                    DELT = STEPN;
                } else {
                    DELT = STEPP;
                }

                ATIME = 0.0;
                XNI = XNQ;
                XLI = XLAMO;
            } else {
                if (Math.abs(T) < Math.abs(ATIME)) {
                    DELT = STEPP;

                    if (T >= 0.0) {
                        DELT = STEPN;
                    }

                    IRET = 100;
                    IRETN = 165;
                    checkIRETN = false;
                } else {
                    DELT = STEPN;

                    if (T > 0.0) {
                        DELT = STEPP;
                    }
                }
            }

            while (true) {
                if (checkIRETN) {
                    if (Math.abs(T - ATIME) >= STEPP) {
                        IRET = 125;
                        IRETN = 165;
                    } else {
                        FT = (T - ATIME);
                        IRETN = 140;
                    }
                }

                checkIRETN = true;

                // DOT TERMS CALCULATED
                if (ISYNFL != 0) {
                    XNDOT = (DEL1 * Math.sin(XLI - FASX2)) +
                        (DEL2 * Math.sin(2.f * (XLI - FASX4))) +
                        (DEL3 * Math.sin(3.f * (XLI - FASX6)));
                    XNDDT = (DEL1 * Math.cos(XLI - FASX2)) +
                        (2.f * DEL2 * Math.cos(2.f * (XLI - FASX4))) +
                        (3.f * DEL3 * Math.cos(3.f * (XLI - FASX6)));
                } else {
                    XOMI = (OMEGAQ + (OMGDT * ATIME));
                    X2OMI = XOMI + XOMI;
                    X2LI = XLI + XLI;
                    XNDOT = (D2201 * Math.sin((X2OMI + XLI) - G22)) +
                        (D2211 * Math.sin(XLI - G22)) +
                        (D3210 * Math.sin((XOMI + XLI) - G32)) +
                        (D3222 * Math.sin((-XOMI + XLI) - G32)) +
                        (D4410 * Math.sin((X2OMI + X2LI) - G44)) +
                        (D4422 * Math.sin(X2LI - G44)) +
                        (D5220 * Math.sin((XOMI + XLI) - G52)) +
                        (D5232 * Math.sin((-XOMI + XLI) - G52)) +
                        (D5421 * Math.sin((XOMI + X2LI) - G54)) +
                        (D5433 * Math.sin((-XOMI + X2LI) - G54));
                    XNDDT = ((D2201 * Math.cos((X2OMI + XLI) - G22)) +
                        (D2211 * Math.cos(XLI - G22)) +
                        (D3210 * Math.cos((XOMI + XLI) - G32)) +
                        (D3222 * Math.cos((-XOMI + XLI) - G32)) +
                        (D5220 * Math.cos((XOMI + XLI) - G52)) +
                        (D5232 * Math.cos((-XOMI + XLI) - G52)) +
                        (2. * ((D4410 * Math.cos((X2OMI + X2LI) - G44)) +
                        (D4422 * Math.cos(X2LI - G44)) +
                        (D5421 * Math.cos((XOMI + X2LI) - G54)) +
                        (D5433 * Math.cos((-XOMI + X2LI) - G54)))));
                }

                XLDOT = XNI + XFACT;
                XNDDT = XNDDT * XLDOT;

                if (IRETN == 140) {
                    XN.value = XNI + (XNDOT * FT) + (XNDDT * FT * FT * 0.5f);
                    XL = XLI + (XLDOT * FT) + (XNDOT * FT * FT * 0.5f);
                    TEMP = (-XNODES.value + THGR + (T * THDT));
                    XLL.value = XL - OMGASM.value + TEMP;

                    if (ISYNFL == 0) {
                        XLL.value = XL + TEMP + TEMP;
                    }

                    return;
                }

                // INTEGRATOR
                XLI = (XLI + (XLDOT * DELT) + (XNDOT * STEP2));
                XNI = (XNI + (XNDOT * DELT) + (XNDDT * STEP2));
                ATIME = ATIME + DELT;

                if (IRET == 100) {
                    break;
                }
            }
        }
    }

    // ENTRANCES FOR LUNAR-SOLAR PERIODICS
    /**
     * DOCUMENT ME!
     *
     * @param EM DOCUMENT ME!
     * @param XINC DOCUMENT ME!
     * @param OMGASM DOCUMENT ME!
     * @param XNODES DOCUMENT ME!
     * @param XLL DOCUMENT ME!
     */
    static void DPPER(DoubleRef EM, DoubleRef XINC, DoubleRef OMGASM,
        DoubleRef XNODES, DoubleRef XLL) {
        SINIS = Math.sin(XINC.value);
        COSIS = Math.cos(XINC.value);

        if (Math.abs(SAVTSN - T) >= 30.0) {
            SAVTSN = T;
            ZM = ZMOS + (ZNS * T);
            ZF = ZM + (2.f * ZES * Math.sin(ZM));
            SINZF = Math.sin(ZF);
            F2 = (.5f * SINZF * SINZF) - .25f;
            F3 = -.5f * SINZF * Math.cos(ZF);
            SES = (SE2 * F2) + (SE3 * F3);
            SIS = (SI2 * F2) + (SI3 * F3);
            SLS = (SL2 * F2) + (SL3 * F3) + (SL4 * SINZF);
            SGHS = (SGH2 * F2) + (SGH3 * F3) + (SGH4 * SINZF);
            SHS = (SH2 * F2) + (SH3 * F3);
            ZM = ZMOL + (ZNL * T);
            ZF = ZM + (2.f * ZEL * Math.sin(ZM));
            SINZF = Math.sin(ZF);
            F2 = (.5f * SINZF * SINZF) - .25f;
            F3 = -.5f * SINZF * Math.cos(ZF);
            SEL = (EE2 * F2) + (E3 * F3);
            SIL = (XI2 * F2) + (XI3 * F3);
            SLL = (XL2 * F2) + (XL3 * F3) + (XL4 * SINZF);
            SGHL = (XGH2 * F2) + (XGH3 * F3) + (XGH4 * SINZF);
            SHL = (XH2 * F2) + (XH3 * F3);
            PE = SES + SEL;
            PINC = SIS + SIL;
            PL = SLS + SLL;
        }

        PGH = SGHS + SGHL;
        PH = SHS + SHL;
        XINC.value = XINC.value + PINC;
        EM.value = EM.value + PE;

        if (XQNCL >= .2) {
            // APPLY PERIODICS DIRECTLY
            PH = PH / SINIQ;
            PGH = PGH - (COSIQ * PH);
            OMGASM.value = OMGASM.value + PGH;
            XNODES.value = XNODES.value + PH;
            XLL.value = XLL.value + PL;
        } else {
            // APPLY PERIODICS WITH LYDDANE MODIFICATION
            SINOK = Math.sin(XNODES.value);
            COSOK = Math.cos(XNODES.value);
            ALFDP = SINIS * SINOK;
            BETDP = SINIS * COSOK;
            DALF = (PH * COSOK) + (PINC * COSIS * SINOK);
            DBET = (-PH * SINOK) + (PINC * COSIS * COSOK);
            ALFDP = ALFDP + DALF;
            BETDP = BETDP + DBET;
            XLS = XLL.value + OMGASM.value + (COSIS * XNODES.value);
            DLS = (PL + PGH) - (PINC * XNODES.value * SINIS);
            XLS = XLS + DLS;
            XNODES.value = MathUtils.ACTAN(ALFDP, BETDP);
            XLL.value = XLL.value + PL;
            OMGASM.value = XLS - XLL.value -
                (Math.cos(XINC.value) * XNODES.value);
        }
    }
}
